<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
<style>
  html, body {
    margin: 0; padding: 0; height: 100%; width: 100%; background: #E4FED1; overflow: hidden; }
  body {
    display: flex;
    justify-content: center;
    align-items: center;
  }
  svg {
    width: 90vmin;   /* این باعث می‌شه همیشه مربع باشه و بزرگ دیده بشه */
    height: 90vmin;
    max-width: 400px;
    max-height: 400px;
  }
  .circle-bg {
    fill: none;
    stroke: #c0e6b0;
    stroke-width: 20;
  }
  .circle-progress {
    fill: none;
    stroke: #6ab04c;
    stroke-width: 20;
    stroke-linecap: round;
    transform: rotate(-90deg);
    transform-origin: center;
    transition: stroke-dashoffset 0.8s ease;
  }
  #percentText {
    font-family: Arial, Helvetica, sans-serif;
    font-size: 48px;
    font-weight: bold;
    fill: #2d5016;
    text-anchor: middle;
    dominant-baseline: middle;
  }
</style>
</head>
<body>

<svg viewBox="0 0 240 240">
  <circle class="circle-bg" cx="120" cy="120" r="100"></circle>
  <circle class="circle-progress" cx="120" cy="120" r="100"></circle>
  <text id="percentText" x="120" y="130">0%</text>
</svg>

<script>
  const circle = document.querySelector('.circle-progress');
  const text   = document.getElementById('percentText');
  const radius = 100;
  const circumference = 2 * Math.PI * radius;
  circle.style.strokeDasharray = circumference;

  function setProgress(percent) {
    if (percent < 0) percent = 0;
    if (percent > 100) percent = 100;
    const offset = circumference - (percent / 100) * circumference;
    circle.style.strokeDashoffset = offset;
    text.textContent = Math.round(percent) + "%";
  }

  // اولین بار صفر نشون بده
  setProgress(0);

  // هر ۲۰۰ میلی‌ثانیه از اپ اینونتور مقدار رو بگیره
  setInterval(() => {
    try {
      let val = AppInventor.getWebViewString();
      let num = parseInt(val);
      if (!isNaN(num)) setProgress(num);
    } catch(e) {}
  }, 200);
</script>

</body>
</html>
